# 第十三章 组件耦合
下面介绍的三个原则是要解决组件间的关系。这里我们又要考虑开发效率和逻辑设计的权衡。冲击构件结构的力量是技术性的，政策性的和不稳定性的。
## 无环依赖原则
> 组件依赖图遵守无环的设计

你是否有过工作了一整天，使得你写的东西跑起来了，然后回家，再第二天早上发现你写的东西不再能正常跑起来了？为什么？因为有些人比你工作的晚，改了你东西的依赖，我称作这种情况为“早晨综合征”。
“早晨综合征”发生在许多开发者可能修改了同样的源文件的开发模式。对于规模小，人数少的项目，这不是大问题。但项目数量一多，开发团队变多，“早晨综合征”真的就是噩梦了。几周都没有团队可能构建一个稳定的项目版本是非常罕见的。每个人都保有变更，并努力使得这些变更最终能和其他人的变更融合，能使系统跑起来。
过去这十年，有两个解决办法都是从通讯行业演变过来。第一个叫“每周构建”，第二个叫无环依赖原则（ADP）。
### 每周构建
每周构建常常用于中等规模的项目。所有的开发者在一周的前四天或略其他开发者的提交，所有开发者都在自己的代码副本里工作，不用考虑和其他人的工作集成。然后到了周五，把所有人的更变集成，再构建系统。
这方法很棒的是允许开发者在前四天独立地工作，缺点很明显，周五的集成非常的痛苦。
不幸的是，随着项目的增长，想要在周五完成项目的集成越来越不现实。集成的时间可能还要延伸到周六，有了周六这样的经历，足够让开发者觉得集成应该成周三就开始，这样开始集成的时间就慢慢移动到了一周的中间。
随着开发时间的占比对于集成时间逐渐下降，团队的开发效率也下降。最后的结果可想而知，开发者和项目管理者，可能宣布将集成时间改为两周一次，这足以能维持一段时间，但是集成时间随着项目规模也将增长。
最后，这种情况将导致灾难。为了维持效率，构建周期继续变长，但变长的构建周期将怎加项目的风险。集成和测试也将更难做，团队丢失了快速回馈的优势。
### 检测依赖环
这个方法是分割开发环境为数个可发布组件。这些组件是数个工作单元，每个工作单元有单个开发者或单个团队负责。当开发者们将一个组件完成，他们可以发布这个组件供其他开发者使用。他们给这个发布组件一个发布号，把它放进某个目录下供娶她团队使用。这样这些开发者可以继续在自己的私有区域继续修改他们的组件。每个人只要用以发布的版本即可。
随着一个个新发布组件的可用，其他团队可以决定是否要马上切换到新的发布版本。如果决定不切换，继续用老版本即可。一旦他们时机成熟，那么就开始用新发布版本。






## 自上而下设计











## 稳定依赖原则









## 稳定抽象原则












## 小结



