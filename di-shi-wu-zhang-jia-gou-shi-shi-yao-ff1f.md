# 第十五章 架构是什么？


## 开发
一个很难开发的软件系统是不太可能有个长寿而健康的生命周期的。所以系统架构应该时这个开发系统的团队容易去开发。

不同团队结构意味着不同架构的决策。一方面，一个五人开发者的团队可以十分有效率地协作开发一个月周期的系统，而不需要精心定义组件和接口。事实上，这样的团队很可能会在早期的开发中，在架构结构层面发现一些障碍。这就是为什么许多的系统缺少良好架构的原因：他们从无开始，因为这个团队很小，不需要上层建筑的障碍。

另一方面，一个系统同时由五个团队开发，每个团队包含七名开发者，除非把系统拆分成定义良好的可靠接口的组件，不然进度堪忧。如果没有考虑这些因素，系统的架构很可能变成每个团队各自开发的五个组件。

每个团队各自开发的五个组件的架构不太可能有最好的系统的部署、运行、维护的架构。尽管如此，这也是一种开发架构，每个团队各自有独立地开发进度计划，多个团队共同开发。

## 部署
为了有效率，一个软件系统一定是可部署的，部署代价越高，系统就越难用。软件架构的一个目标是使得系统可以容易部署，一键部署（with a single action）！

不幸的是，在初始开发阶段，很少考虑部署策略。这导致了一个架构可能容易开发，但极难部署。

比如，在早期系统开发，开发者决定用“微服务架构”，他们觉得这种方式让系统变得容易开发，因为组件边界是确定的，接口也相对稳定。但是，到了部署系统的时候，他们发现微服务的数量变得有点可怕了：配置微服务之间的连接，以及它们启动的时间，也可能变成一个巨大的错误来源。

如果架构师尽早考虑部署问题，他们可能会决定减少服务，混合使用服务和在线处理的组件，并采用更为集成的方式来管理互连。[^1]

## 运行
架构对系统运行的影响比对开发、部署、维护的影响要小，几乎所有运行的问题都可以靠增加硬件解决而不影响到软件架构。

确实，我们多次看到这样的情况了。架构不够有效的系统软件常常可以通过怎家存储，增加服务器资源来提高效能。硬件是廉价的而人力是昂贵的意味着架构对处理运行的障碍的代价并不会大于对开发、部署、维护的障碍的代价。

这并不是说良好的架构对系统的运行不重要。重要的，但只是会在开发、部署、维护话更多代价。

讲到这里，架构在系统运行打的另一个作用是：一个好的软件架构可以传达系统的运行需求。

也许更好的说法是，对于开发者来说系统的体系架构使得系统运行是显而易见的。 架构应该揭示运行。 系统的体系架构应该将系统的用例，功能特性和所需的行为提升到开发人员可视的标记的第一类实体。 [^2]这简化了对系统的理解，因此大大有助于开发和维护。

## 维护
软件系统的所有方面里，维护的成本最大。新功能的不断迭代和必然的缺陷修正消耗了大量的人力资源。

维护的主要成本是在探索（spelunking）和风险。 探索是挖掘现有软件的成本，试图确定添加新功能或修复缺陷的最佳位置和最佳策略。 但在做出这样的改变的同时，造成不经意的缺陷的可能性总是存在，增加了风险成本。

经过仔细思考的架构大大减轻了这些成本。 通过将系统分成组件，并通过稳定的接口隔离这些组件，可以为未来的功能特性打好基础，并大大降低无意中破坏的风险。

## 保持可选项开放

如我们在之前章节的描述，软件有两类值：它的行为的值和它的结构值。第二个值相较而言更重要，因为它使得软件“软”。

[^1]: Had the architects considered deployment issues early on, they might have decided on fewer services, a hybrid of services and in-process components, and a more integrated means of managing the interconnections.
[^2]: Architecture should reveal operation. The architecture of the system should elevate the use cases, the features, and the required behaviors of the system to first-class entities that are visible landmarks for the developers.
